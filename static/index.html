<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sussex County Alerts</title>
  <link rel="stylesheet" href="/static/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/wavesurfer.js@7/dist/wavesurfer.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
</head>
<body data-dev-mode="__DEV_MODE__" data-default-cleanup="__DEFAULT_CLEANUP__">
  <div class="page">
    <header class="app-header">
      <div>
        <p class="eyebrow">Sussex County Alerts</p>
        <h1>Unified Call Monitor</h1>
        <p class="muted">Live call ingestion with quick filtering, waveform playback, and transcript review.</p>
      </div>
      <div class="pill-group" aria-label="System indicators">
        <div class="pill">
          <span class="label">Queue</span>
          <strong id="queue-level">--</strong>
          <small id="queue-capacity" class="muted"></small>
        </div>
        <div class="pill">
          <span class="label">Workers</span>
          <strong id="worker-count">--</strong>
          <small class="muted">active</small>
        </div>
        <div class="pill">
          <span class="label">Processed</span>
          <strong id="stat-processed">--</strong>
          <small class="muted">total</small>
        </div>
      </div>
    </header>

    <section class="controls">
      <div class="field">
        <label for="search">Search</label>
        <input id="search" type="search" placeholder="Search filename or transcript" />
      </div>
      <div class="field">
        <label for="status-filter">Status</label>
        <select id="status-filter">
          <option value="">All</option>
          <option value="done">Success</option>
          <option value="processing">Processing</option>
          <option value="queued">Queued</option>
          <option value="error">Failed</option>
        </select>
      </div>
      <div class="field">
        <label for="tag-filter">Tag</label>
        <select id="tag-filter">
          <option value="">All tags</option>
        </select>
      </div>
      <div class="window-switch" role="group" aria-label="Time window">
        <button class="chip active" data-window="24h">24h</button>
        <button class="chip" data-window="7d">7d</button>
        <button class="chip" data-window="30d">30d</button>
      </div>
      <button id="refresh-btn" class="primary">Refresh</button>
    </section>

    <main class="layout">
      <section class="panel list-panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Recent activity</p>
            <h2>Calls</h2>
            <p class="muted" id="list-caption">Showing the latest 24h by default.</p>
          </div>
        </div>
        <div id="list" class="call-list" role="list"></div>
        <div id="empty-state" class="empty hidden">No calls in this window.</div>
        <div id="list-error" class="error hidden" role="alert">Unable to load calls. Please try again.</div>
      </section>

      <section class="panel detail-panel">
        <div class="panel-header">
          <div>
            <p class="eyebrow">Details</p>
            <h2 id="detail-title">Select a call</h2>
            <p class="muted" id="detail-meta">Choose an item from the list to view transcript and metadata.</p>
          </div>
        </div>
        <div id="detail-content" class="detail-content">
          <div class="badge-row" id="detail-badges"></div>
          <p class="muted" id="detail-location"></p>
          <div class="wave-wrap hidden" id="wave-wrap">
            <div id="waveform"></div>
            <div class="player-controls">
              <button id="play-toggle" class="primary">Play / Pause</button>
              <a id="detail-audio" class="audio-link" target="_blank" rel="noopener">Open audio file</a>
            </div>
          </div>
          <div class="transcript-tabs" aria-label="Transcript view">
            <button data-tab="clean" class="active">Cleaned</button>
            <button data-tab="raw">Raw</button>
            <button data-tab="translation">Translation</button>
          </div>
          <pre id="transcript-text" class="transcript-body">No call selected.</pre>
        </div>
      </section>
    </main>

    <section class="panel analytics-panel">
      <div class="panel-header">
        <div>
          <p class="eyebrow">Snapshot</p>
          <h2>Current window</h2>
          <p class="muted">Tags and quick visuals update with your filters.</p>
        </div>
        <button id="retry-status" class="ghost">Reload status</button>
      </div>
      <div class="analytics-grid">
        <div>
          <div id="tag-cloud" class="tag-cloud"></div>
        </div>
        <div id="plot-status" class="plot"></div>
        <div id="plot-tags" class="plot"></div>
      </div>
    </section>
  </div>
  <script src="/static/app.js"></script>
</body>
</html>
